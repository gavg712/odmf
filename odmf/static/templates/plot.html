<!DOCTYPE html>

<py:extends href="bootstrap_navigation.html" xmlns:py="">
    <py:block name="scripts">
        <script type="text/javascript" py:if="plot">
            sessionStorage.setItem('plot', JSON.stringify(${literal(as_json(plot))}, 4));
        </script>

        <script type="text/javascript" src="${conf.root_url}/media/js/plot.js"/>
        <script type="text/javascript" py:if="error">
            $(() =>{
                $('#error').html('${markdown(error)}')
                $('#error-row').removeClass('d-none')
            })
        </script>

        <div class="d-none"  id="subplot-template" type="template" >
            <div class="subplot card mb-2 w-100">
                <div class="card-header">
                    <h5 class="card-title">plot §position§
                        <span class="btn-group card-text">
                            <button data-subplot="§position§"
                                    class="sp-remove-button btn btn-sm btn-danger py-0" data-toggle="tooltip"
                                    title="remove subplot §position§ from figure"
                            >
                                <i class="fas fa-times-circle"/>
                            </button>
                            <button class="sp-changeylimit-button btn btn-sm btn-primary py-0" data-toggle="tooltip" data-subplot="§position§"
                                    title="change y axis limit"
                            >
                                <i>y</i>&#x2195;
                            </button>
                            <button data-toggle="dropdown" class="btn btn-sm btn-primary py-0 dropdown-toggle sp-logsite-button"
                                    data-subplot="§position§">
                                <i class="fas fa-tags" data-toggle="tooltip" title="Show logged events at a site in the graph"/> #§logsite§
                            </button>
                            <div class="dropdown-menu sp-logsite-list" data-subplot="§position§">
                            </div>
                        </span>
                    </h5>
                </div>
                <div class="card-body">

                    <ul id="line-list" class="list-group list-group-flush">
                        <li class="newline list-group-item">
                            <button class="btn btn-sm btn-primary btn-outline shadow py-0" data-toggle="modal" data-target="#newline-dialog"
                                    data-subplot="§position§" id="addline_§position§">
                                <i class="fas fa-plus-circle"/> add line...
                            </button>
                        </li>
                    </ul>
                </div>

            </div>

        </div>
        <div class="d-none" id="line-template" type="template">
            <li class="line list-group-item">
                <div class="btn-group" id="linetools_§sp_pos§_§i§">
                    <div class="btn btn-sm btn-light" style="color:§color§; font-weight: bolder"
                         data-toggle="collapse" data-target="#line-name_§sp_pos§_§i§" aria-expanded="false" aria-controls="line-name_§sp_pos§_§i§">
                        §linestyle§ §marker§
                    </div>
                    <button title="remove line" class="btn btn-sm py-0 btn-secondary removeline"
                            data-toggle="tooltip"  data-html="true" data-lineno="§i§" data-subplot="§sp_pos§">
                        <i class="fas fa-times-circle"/>
                    </button>
                    <button class="btn btn-sm py-0 btn-secondary exportline"
                            data-toggle="tooltip" title="export to csv file..." data-lineno="§i§" data-subplot="§sp_pos§">
                        <i class="fas fa-file-csv"/>

                    </button>
                    <button class="btn btn-sm py-0 btn-secondary showdataset"
                            data-toggle="tooltip" data-html="true"  title="show datasets of line" data-lineno="§i§" data-subplot="§sp_pos§">
                        <i class="fas fa-list"/>
                    </button>
                    <button title="edit line" class="btn btn-sm py-0 btn-secondary editline" data-toggle="modal" data-target="#newline-dialog"
                            data-lineno="§i§" data-subplot="§sp_pos§" data-replace="replace">
                        <i class="fas fa-edit"/>
                    </button>
                    <button title="copy line" class="btn btn-sm py-0 btn-secondary editline" data-toggle="modal" data-target="#newline-dialog" id="copyline_§position§_§i§"
                            data-lineno="§i§" data-subplot="§sp_pos§">
                        <i class="fas fa-copy"/>
                    </button>

                </div>
                <div id="line-name_§sp_pos§_§i§" class="collapse">§linename§</div>

                <ul id="datasetlist_§sp_pos§_§i§" class="datasetlist small doc"/>
            </li>

        </div>
    </py:block>0
    <py:block name="style">
        <style type="text/css">
            .firstoption {font-style: italic;color: grey;}
            li.line {
                background-color: #FFF;
            }
            .filter {
                max-width: 8em;
            }
            .nowrap {white-space: nowrap;}
            #description textarea {
                width: 100%;
                font-family: monospace;
                cursor: auto;
            }
            .transition {
                transition: 0.5s;
            }
            .semitransparent {
                opacity: 30%;
            }
            .fig-subtitle {
                border-top: black 1px;
            }
        </style>
    </py:block>
    <py:block name="sidebar">
        <div class="container-fluid ">

            <div id="collapse-buttons" class="btn-group-vertical w-100">
                <button class="btn btn-outline-danger" id="btn-clf" role="button">
                    <i class="fas fa-times-circle"/> clear figure
                </button>
                <button class="btn btn-outline-primary"
                        id="toolbar-toggle" data-toggle="modal" data-target="#file-dialog"
                        role="button" aria-controls="file-dialog">
                    <i class="fas fa-file"/> File...
                </button>
                <button class="btn btn-outline-primary"
                        id="property-toggle" data-toggle="modal" data-target="#property-dialog"
                        role="tab" aria-controls="property-dialog">
                    <i class="fas fa-cog"/> Properties...
                </button>
                <div class="btn-group" id="fig-export">
                    <button class="btn btn-outline-primary"
                            id="json-toggle" data-toggle="modal" data-target="#json-dialog"
                            role="tab" aria-controls="json-dialog">
                        {}
                    </button>
                    <button data-format="png" class="btn btn-outline-primary" data-toggle="tooltip" title="Export as PNG"><i class="fas fa-file-image"/></button>
                    <button data-format="svg" class="btn btn-outline-primary" data-toggle="tooltip" title="Export as SVG"><i class="fas fa-file-code"/></button>
                    <button data-format="pdf" class="btn btn-outline-primary" data-toggle="tooltip" title="Export as PDF"><i class="fas fa-file-pdf"/></button>
                </div>
            </div>
            <div id="content-tree" class="mt-2 w-100">
                <h4 id="plot-name">name...</h4>

                <!--
                    Subplots
                -->

                <div id="ct-new-subplot" class="card mb-2 w-100">
                    <div class="card-body">
                        <div class="card-title">
                            <button id="addsubplot" onclick="addsubplot()" class="btn btn-primary mr-2">
                                <i class="fas fa-plus-circle"/>
                            </button>
                            add subplot
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </py:block>
    <py:block name="content">
        <div class="container-fluid m-0 p-0">
            <div id="error-row" class="row mt-2 w-100 d-none">
                <div class="container">
                    <div class="row bg-danger text-white border rounded p-4">
                        <h1 class="display-3 col-lg-2">Error</h1>
                        <div class="lead col-lg-10" id="error" />
                    </div>

                </div>
            </div>
            <div id="plot-row" class="">
                <div id="plot" class="bg-light border">
                    PLOT
                </div>
                <div id="plot-reload-button" class="position-absolute" style="top: 10em; left: 10em">
                    <button id="reload_plot" class="btn btn-outline-primary bg-light shadow transition">
                        <h3><i class="fas fa-sync-alt"/> reload plot</h3>
                    </button>
                </div>

            </div>
        </div>

    </py:block>
    <py:block name="extrahtml">
        <div id="property-dialog" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header bg-primary text-light">
                        <h5 class="modal-title"><i class="fas fa-cog"/> Properties</h5>
                    </div>
                    <div class="modal-body form-group">
                        <label for="startdatetime">start:</label>
                        <div id="startdatetime" class="input-group">
                            <input class="props form-control" type="date" id="startdate"
                                   value=""/>
                            <input class="props timepicker form-control" id="starttime"
                                   value="00:00"/>
                        </div>
                        <label for="enddatetime">end:</label>
                        <div id="enddatetime" class="input-group">

                            <input class="props form-control" type="date" id="enddate"
                                   value=""/>
                            <input class="props timepicker form-control" id="endtime"
                                   value="00:00"/>
                        </div>
                        <label for="prop-columns">Subplot columns</label>
                        <input id ="prop-columns" class="props form-control" type="number" value="1" max="1" min="1"/>
                        <label for="plotaggregate">Aggregation:
                            <a class="btn btn-secondary"
                               href="${conf.root_url}/wiki/plot/aggregate"
                               title="What is aggregation?" data-toggle="tooltip"
                            >
                                <i class="fas fa-question"/>
                            </a>
                        </label>
                        <select id="plotaggregate" class="props form-control">
                            <option value="">No aggregation</option>
                            <option value="30Min">Half hourly</option>
                            <option value="h" >Hourly</option>
                            <option value="D" >Daily</option>
                            <option value="W" >Weekly</option>
                            <option value="M" >Monthly</option>
                            <option value="Y" >Yearly</option>
                        </select>
                        <label for="prop-description">Description (markdown)</label>
                        <textarea id="prop-description" rows="" class="form-control"></textarea>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                        <button id="prop-OK" type="button" class="btn btn-primary" data-dismiss="modal">OK</button>
                    </div>
                </div>
            </div>
        </div>

        <div id="file-dialog" class="modal fade" tabindex="-1" role="dialog"  aria-hidden="true">
            <div class="modal-dialog" id="file-dialog-content">
            </div>
        </div>

        <div id="newline-dialog" class="modal fade" tabindex="-1" role="dialog" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header bg-primary text-light">
                        <h5 class="modal-title">Subplot <span id="newline-subplot">0</span></h5>
                    </div>
                    <div class="modal-body form-group">
                        <label for="nl-name">Name:</label>
                        <input type="text" id="nl-name" class="form-control"/>
                        <label for="nl-value">value:</label>
                        <select id="nl-value" class="form-control">
                            <option value="" class="firstoption">Please select...</option>
                        </select>

                        <label for="nl-site">site:</label>
                        <select id="nl-site"  class="form-control">
                            <option value="" class="firstoption">Please select...</option>
                        </select>
                        <div class="form-group">
                            <label for="nl-level">level:</label>
                            <select id="nl-level"  class="form-control">
                                <option value="" class="firstoption">Please select...</option>
                            </select>
                        </div>

                        <label for="nl-instrument">instrument:</label>
                        <select id="nl-instrument" class="form-control">
                            <option value="" class="firstoption">Please select...</option>
                        </select>

                        <label for="nl-marker">marker:</label>
                        <select id="nl-marker" class="form-control">
                            <option value="">none</option>
                            <option value="x">x</option>
                            <option value="o">o</option>
                            <option value=".">.</option>
                            <option value="|">|</option>
                            <option value="+">+</option>
                            <option value="*">*</option>
                        </select>

                        <label for="nl-linestyle">line:</label>
                        <select id="nl-linestyle" class="form-control">
                            <option value="-">-</option>
                            <option value="">none</option>
                            <option value=":">...</option>
                            <option value="--">--</option>
                            <option value="-.">-.</option>
                        </select>

                        <label for="nl-color">color:</label>
                        <select id="nl-color" class="form-control">
                            <option py:for="c in ['#000000' ,'#0000FF','#00FF00','#FF0000', '#FFFF00','#00FFFF','#FF00FF']"
                                    value="${c}" py:content="c" style="background-color: ${c}"

                            />
                        </select>

                        <label for="nl-aggregation">aggregate:</label>
                        <select id="nl-aggregation" class="form-control">
                            <option value="mean">mean</option>
                            <option value="min">min</option>
                            <option value="max">max</option>
                            <option value="stdev">stdev</option>
                            <option value="sum">&Sigma;</option>
                        </select>


                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                        <button id="nl-OK" type="button" class="btn btn-primary" data-dismiss="modal">OK</button>
                    </div>

                </div>
            </div>
        </div>

        <div id="json-dialog" class="modal fade" tabindex="-1" role="dialog" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header bg-primary text-light">
                        <h5 class="modal-title">JSON-Description of plot</h5>
                    </div>
                    <div class="modal-body" id="json-row">
                        <pre></pre>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    </div>
                </div>

            </div>

        </div>

    </py:block>
</py:extends>

